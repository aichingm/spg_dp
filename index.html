<!doctype html>
<html lang="en">
    <head>
        <title>SPG_DP</title>
        <meta charset="utf-8">
        <link rel="shortcut icon"  href="/favicon.png">
        <link rel="stylesheet" type="text/css" href="styles.css">
    </head>
    <body>
        <script src="js/three.min.js"></script>
        <script src="js/OrbitControls.js"></script>
        <script src="js/threex.transparency.js"></script>
        <script src="js/jquery-2.1.3.min.js"></script>
        <script type="text/javascript" src="js/drawing/function.draw.js"></script>
        <script type="text/javascript" src="js/Geometries.js"></script>
        <script type="text/javascript" src="js/Materials.js"></script>
        <script type="text/javascript" src="js/events/on.document.keypress.js"></script>
        <script type="text/javascript" src="js/events/on.document.ready.js"></script>
        <script>
            // JsHint directives
            /* global THREE */
            /* global THREEx */
            /* global Storage */
            var updateFcts = [];
            var scene, camera, renderer;
            function clearScene() {
                var obj, i;
                for (i = scene.children.length - 1; i >= 0; i--) {
                    obj = scene.children[ i ];
                    if (obj !== camera) {
                        scene.remove(obj);
                    }
                }
            }
            // Set up the scene, camera, and renderer as global variables.
            init();
            animate();
            // Sets up the scene.
            function init() {
                // Create the scene and set the scene size.
                scene = new THREE.Scene();
                var WIDTH = window.innerWidth,
                        HEIGHT = window.innerHeight;
                // Create a renderer and add it to the DOM.
                renderer = new THREE.WebGLRenderer({antialias: true});
                renderer.setSize(WIDTH, HEIGHT);
                document.body.appendChild(renderer.domElement);
                // Create a camera, zoom it out from the model a bit, and add it to the scene.
                camera = new THREE.PerspectiveCamera(70, WIDTH / HEIGHT, 0.1, 2000000000);
                camera.position.set(1000, 1000, 1000);
                camera.lookAt(new THREE.Vector3(0, 0, 0));
                scene.add(camera);
                // Create an event listener that resizes the renderer with the browser window.
                window.addEventListener('resize', function () {
                    var WIDTH = window.innerWidth,
                            HEIGHT = window.innerHeight;
                    renderer.setSize(WIDTH, HEIGHT);
                    camera.aspect = WIDTH / HEIGHT;
                    camera.updateProjectionMatrix();
                });
                // Set the background color of the scene.
                //renderer.setClearColorHex(0x333F47, 1);
                renderer.setClearColor(0x333F47, 1);
                // Create a light, set its position, and add it to the scene.
                //var light = new THREE.PointLight(0xffffff, 1000, 0);
                //light.position.set(-1000, 2000, 1000);
                //scene.add(light);
                controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.userPanSpeed = 15;
            }


            // Renders the scene and updates the render as needed.
            function animate() {
                requestAnimationFrame(animate);
                // Render the scene.
                renderer.render(scene, camera);
                controls.update();
                updateFcts.forEach(function (updateFn) {
                    updateFn();
                });
            }
            
            function buildShowDiv() {
                if (typeof (Storage) !== "undefined") {
                    var exports = localStorage.getItem("PieceofShit.exports");
                    //check if they are valid
                    if (exports !== null && exports !== undefined && exports.length > 0) {
                        //draw them
                        var data = JSON.parse(exports);
                        $("#drawFloors").html("");
                        $(data.modelManager.floors).each(function (k) {
                            $("#drawFloors").append("<option selected='selected' value='" + k + "'>" + this.name + "</option>");
                        });
                        $("#drawFloors").attr("size", data.modelManager.floors.length);
                    }
                    $("#drawFloors").change(function (e) {
                        if (typeof (Storage) !== "undefined") {
                            var exports = localStorage.getItem("PieceofShit.exports");
                            //check if they are valid
                            if (exports !== null && exports !== undefined && exports.length > 0) {
                                //draw them
                                draw(JSON.parse(exports), true);
                            }
                        }
                    });
                }
            }
        </script>
        <div id="settings">
            <div class="settingsLine settingsLineH1">
                Settings
            </div>
            <div class="settingsLine">
                Draw Floors<br>
                <select multiple="" id="drawFloors">
                </select>
            </div>
        </div>
    </body>
</html>
